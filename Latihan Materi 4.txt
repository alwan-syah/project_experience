Latihan Materi 4

1. Write a query in SQL to list all the information of the actors who played a role in the movie 'Annie Hall'.
Code :
select actor.act_id, actor.act_fname, actor.act_lname, actor.act_gender, movie_cast.role, movie.mov_title
from actor, movie_cast, movie
where actor.act_id = movie_cast.act_id
and movie_cast.mov_id = movie.mov_id
and movie.mov_title = 'Annie Hall'

2. Write a query in SQL to find the name of the director(first and last names) who directed a movie that casted a role for 'Eyes Wide Shut'.(using subquery)
Code : 
select (dir_fname||' '||dir_lname) asdirectpr_fullname
from director
where dir_id = 
	(select dir_id
	from movie_direction
	where mov_id = 
		(select mov_id
		from movie
		where mov_title = 'Eyes Wide Shut'))

3. Write a query in SQL to list all the movies which released in the country other than UK.
Code :
select *
from movie
where not mov_rel_country = 'UK'

4. Write a query in SQL to find the movie title, year date of releasem director and actor for those movies which reviewer is unknown.
Code :
select movie.mov_title, movie.mov_year, movie.mov_dt_rel, director.dir_fname, 
	director.dir_lname, (actor.act_fname||' '||actor.act_lname) as actor_fullname
from movie
inner join movie_direction on movie.mov_id = movie_direction.mov_id
inner join movie_cast on movie_direction.mov_id = movie_cast.mov_id
inner join rating on movie_cast.mov_id = rating.mov_id
inner join reviewer on rating.rev_id = reviewer.rev_id
inner join director on movie_direction.dir_id = director.dir_id
inner join actor on movie_cast.act_id = actor.act_id
where reviewer.rev_name is null

5. Write a query in SQL to find the titles of all movies directed by the director whose first and last name are Woody Allen.
Code :
select mov_title
from movie
where mov_id = 
	(select mov_id
	from movie_direction
	where dir_id = 
		(select dir_id
		from director
		where dir_fname = 'Woody' and dir_lname = 'Allen'))

6.Write a query in SQL to find all the years which produced at least one movie and that received a rating of more than 3 stars. show the result in increasing order.
Code :
select distinct movie.mov_year, rating.rev_stars
from movie, rating
where movie.mov_id = rating.mov_id
and rating.rev_stars > 3
order by movie.mov_year

7. Write a query in SQL to find the titles of all movies that have no ratings.
Code :
select mov_title
from movie
where mov_id in
	(select mov_id
	 from rating
	 where rev_stars is null)

8. Write a query in SQL to find the names of all reviewers who have ratings with a Null value.
Code :
select rev_name
from reviewer 
where rev_id in
	(select rev_id
	from rating
	where rev_stars is null)

9. Write a query in SQL to return the reviewer name, movie title, and stars for those movie which reviewed by a reviewer and must be rated. sort the result by reviewer name, movie title, and number of stars.
Code :
select reviewer.rev_name, movie.mov_title, rating.rev_stars
from Reviewer
inner join rating on reviewer.rev_id = rating.rev_id
inner join movie on rating.mov_id = movie.mov_id
where rating.rev_stars is not null
and reviewer.rev_name is not null
order by reviewer.rev_name, movie.mov_title, rating.rev_stars

10. Write a query in SQL to find the reviewer's name and the title of the movie for those reviewers who rated more than one movies.
Code :
select reviewer.rev_name, movie.mov_title
from reviewer
inner join rating on reviewer.rev_id = rating.rev_id
inner join movie on rating.mov_id = movie.mov_id
where rating.rev_id =
(select rev_id
from rating
group by rev_id
having count(*) > 1)


11. Write a query in SQL to find the movie title, and the highest number of stars that movie received and arranged the resukt according to the group of a movie and the movie title appear alphabetically in ascending order.
Code :
select movie.mov_title, rating.rev_stars
from movie
inner join rating on movie.mov_id = rating.mov_id
where rating.rev_stars = 
	(select max(rev_stars)
	from rating)
order by movie.mov_title

12. Write a query in SQL to find name of all reviewers who rated the American Beauty.
Code : 
select rev_name
from reviewer 
where rev_id = 
	(select rev_id
	from rating
	where mov_id = 
	(select mov_id
	from movie
	where mov_title = 'American Beauty'))

13. Write a query in SQL to find the titles of all movies which have been reviewed by anybody except by Paul Monks.
Code :
select mov_title
from movie
where mov_id in
	(select mov_id
	from rating
	where rev_id in
		(select rev_id
		from reviewer
		where not rev_name = 'Paul Monks'))
order by mov_title

14. Write a query in SQL to return the reviewer name, movie title, and number of stars for those movies which rating is the lowest one.
Code : 
select reviewer.rev_name, movie.mov_title, rating.rev_stars
from reviewer
inner join rating on reviewer.rev_id = rating.rev_id
inner join movie on rating.mov_id = movie.mov_id
where rating.rev_stars =
	(select min(rev_stars)
	from rating)

15. Write a query in SQL to find the titles of all movies directed by James Cameron.
Code :
select mov_title
from movie
where mov_id in
	(select mov_id
	from movie_direction
	where dir_id = 
		(select dir_id
		from director
		where (dir_fname||' '||dir_lname) = 'James Cameron'))

16 Write a query in SQL to find the name of those movies where one or more actors acted in two or more movies.
Code :
select mov_title
from movie
inner join movie_cast on movie.mov_id = movie_cast.mov_id
where movie_cast.act_id = 
	(select act_id
	from movie_cast
	group by act_id
	having count(*) > 1)